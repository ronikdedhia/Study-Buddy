{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useEffect } from 'react';\nimport { Camera } from 'expo-camera';\nimport { Ionicons } from '@expo/vector-icons';\nimport { Col, Row, Grid } from \"react-native-easy-grid\";\nimport View from \"react-native-web/dist/exports/View\";\nimport TouchableWithoutFeedback from \"react-native-web/dist/exports/TouchableWithoutFeedback\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { Feather } from '@expo/vector-icons';\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\nimport { MaterialIcons } from '@expo/vector-icons';\nimport styles from \"../constants/styles\";\nimport * as Location from 'expo-location';\nimport axios from \"axios\";\nimport Constants from \"../constants/text\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Toolbar(_ref) {\n  var cameraRef = _ref.cameraRef,\n    navigation = _ref.navigation;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    location = _useState2[0],\n    setLocation = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    errorMsg = _useState4[0],\n    setErrorMsg = _useState4[1];\n  var _useState5 = useState({}),\n    _useState6 = _slicedToArray(_useState5, 2),\n    userData = _useState6[0],\n    setuserData = _useState6[1];\n  useEffect(function () {\n    _asyncToGenerator(function* () {\n      var _yield$Location$reque = yield Location.requestForegroundPermissionsAsync(),\n        status = _yield$Location$reque.status;\n      if (status !== 'granted') {\n        setErrorMsg('Permission to access location was denied');\n      }\n      var location = yield Location.getCurrentPositionAsync({});\n      setLocation(location);\n    })();\n  });\n  var _useState7 = useState(false),\n    _useState8 = _slicedToArray(_useState7, 2),\n    capturing = _useState8[0],\n    setCapturing = _useState8[1];\n  var _useState9 = useState(null),\n    _useState10 = _slicedToArray(_useState9, 2),\n    image = _useState10[0],\n    setImage = _useState10[1];\n  var _useState11 = useState(false),\n    _useState12 = _slicedToArray(_useState11, 2),\n    IsImage = _useState12[0],\n    setIsImage = _useState12[1];\n  function takePicture() {\n    return _takePicture.apply(this, arguments);\n  }\n  function _takePicture() {\n    _takePicture = _asyncToGenerator(function* () {\n      if (cameraRef) {\n        setCapturing(true);\n        var options = {\n          quality: 0.1,\n          base64: true,\n          uri: true\n        };\n        var photo = yield cameraRef.takePictureAsync(options);\n        setCapturing(false);\n        setIsImage(true);\n        setImage(photo.base64);\n        yield cameraRef.pausePreview();\n      }\n    });\n    return _takePicture.apply(this, arguments);\n  }\n  function uploadData() {\n    return _uploadData.apply(this, arguments);\n  }\n  function _uploadData() {\n    _uploadData = _asyncToGenerator(function* () {\n      setIsImage(false);\n      var response = yield AsyncStorage.getItem(\"userData\");\n      response = JSON.parse(response);\n      console.log('\\n\\n\\n\\noriginal data:' + JSON.stringify(response.data.user_email));\n      var location = yield Location.getCurrentPositionAsync({});\n      var data = {\n        \"image_link\": image,\n        \"grievance_id\": Math.random().toString(36).substring(7),\n        \"user_id\": response.data.user_email,\n        \"grievance_type\": \"unpredicted\",\n        \"latitude\": location.coords.latitude,\n        \"longitude\": location.coords.longitude\n      };\n      console.log('this is your data: ' + JSON.stringify(data));\n      axios.post(Constants.ApiLink + \"/uploader\", data).then(function () {\n        var _ref3 = _asyncToGenerator(function* (response) {\n          try {\n            var jsonValue = JSON.stringify(response.data);\n            yield AsyncStorage.setItem(\"value\", jsonValue);\n            console.log(\"data: \" + jsonValue);\n          } catch (e) {\n            console.log(\"Got error while storing data to async\" + e);\n          }\n        });\n        return function (_x) {\n          return _ref3.apply(this, arguments);\n        };\n      }()).catch(function (error) {\n        console.log(\"ERROR ON HOME\", error);\n      }).finally(function () {});\n      yield cameraRef.resumePreview();\n    });\n    return _uploadData.apply(this, arguments);\n  }\n  function account() {\n    return _account.apply(this, arguments);\n  }\n  function _account() {\n    _account = _asyncToGenerator(function* () {\n      navigation.navigate('Profile');\n    });\n    return _account.apply(this, arguments);\n  }\n  return _jsx(Grid, {\n    style: styles.bottomToolbar,\n    children: _jsxs(Row, {\n      children: [_jsx(Col, {\n        style: styles.alignCenter,\n        children: _jsx(TouchableOpacity, {\n          onPress: function onPress() {\n            return navigation.navigate('EntryRecords');\n          },\n          children: _jsx(MaterialIcons, {\n            name: \"history\",\n            size: 30,\n            color: \"white\"\n          })\n        })\n      }), _jsx(Col, {\n        size: 2,\n        style: styles.alignCenter,\n        children: _jsx(TouchableWithoutFeedback, {\n          onPress: takePicture,\n          children: _jsx(View, {\n            style: [styles.captureBtn, capturing && styles.captureBtnActive],\n            children: capturing && _jsx(View, {\n              style: styles.captureBtnInternal\n            })\n          })\n        })\n      }), IsImage ? _jsx(Col, {\n        style: styles.alignCenter,\n        children: _jsx(TouchableOpacity, {\n          onPress: uploadData,\n          children: _jsx(Feather, {\n            name: \"check\",\n            size: 30,\n            color: \"white\"\n          })\n        })\n      }) : _jsx(Col, {\n        style: styles.alignCenter,\n        children: _jsx(TouchableOpacity, {\n          onPress: account,\n          children: _jsx(MaterialCommunityIcons, {\n            name: \"account\",\n            size: 30,\n            color: \"white\"\n          })\n        })\n      })]\n    })\n  });\n}","map":{"version":3,"names":["React","useState","useEffect","Camera","Ionicons","Col","Row","Grid","Feather","MaterialCommunityIcons","MaterialIcons","styles","Location","axios","Constants","AsyncStorage","Toolbar","cameraRef","navigation","location","setLocation","errorMsg","setErrorMsg","userData","setuserData","requestForegroundPermissionsAsync","status","getCurrentPositionAsync","capturing","setCapturing","image","setImage","IsImage","setIsImage","takePicture","options","quality","base64","uri","photo","takePictureAsync","pausePreview","uploadData","response","getItem","JSON","parse","console","log","stringify","data","user_email","Math","random","toString","substring","coords","latitude","longitude","post","ApiLink","then","jsonValue","setItem","e","catch","error","finally","resumePreview","account","navigate","bottomToolbar","alignCenter","captureBtn","captureBtnActive","captureBtnInternal"],"sources":["C:/Users/rudra/OneDrive/Desktop/Projects/ipd-task/app/components/toolbar.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport { Camera } from 'expo-camera';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { Col, Row, Grid } from \"react-native-easy-grid\";\r\nimport { View, TouchableWithoutFeedback, TouchableOpacity } from 'react-native';\r\nimport { Feather } from '@expo/vector-icons';\r\nimport { MaterialCommunityIcons } from '@expo/vector-icons';\r\nimport { MaterialIcons } from '@expo/vector-icons';\r\nimport styles from '../constants/styles';\r\nimport * as Location from 'expo-location';\r\nimport axios from \"axios\";\r\nimport Constants from '../constants/text';\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nexport default function Toolbar({ cameraRef, navigation }) {\r\n    const [location, setLocation] = useState(null);\r\n    const [errorMsg, setErrorMsg] = useState(null);\r\n    const [userData, setuserData] = useState({});\r\n\r\n    useEffect(() => {\r\n        (async () => {\r\n            let { status } = await Location.requestForegroundPermissionsAsync();\r\n            if (status !== 'granted') {\r\n                setErrorMsg('Permission to access location was denied');\r\n            }\r\n\r\n            let location = await Location.getCurrentPositionAsync({});\r\n            setLocation(location);\r\n        })();\r\n    });\r\n\r\n\r\n\r\n    const [capturing, setCapturing] = useState(false)\r\n    const [image, setImage] = useState(null)\r\n    const [IsImage, setIsImage] = useState(false)\r\n\r\n    async function takePicture() {\r\n\r\n        if (cameraRef) {\r\n            setCapturing(true)\r\n            const options = { quality: 0.1, base64: true, uri: true };\r\n            let photo = await cameraRef.takePictureAsync(options);\r\n            setCapturing(false)\r\n            setIsImage(true)\r\n            setImage(photo.base64)\r\n            await cameraRef.pausePreview()\r\n        }\r\n\r\n    }\r\n\r\n    async function uploadData() {\r\n        setIsImage(false)\r\n        let response=await AsyncStorage.getItem(\"userData\")\r\n        \r\n        response = JSON.parse(response);\r\n        console.log('\\n\\n\\n\\noriginal data:'+JSON.stringify(response.data.user_email))\r\n        let location = await Location.getCurrentPositionAsync({});\r\n       \r\n        const data = {\r\n            \"image_link\": image,\r\n            \"grievance_id\": Math.random().toString(36).substring(7),\r\n            \"user_id\": response.data.user_email,\r\n            \"grievance_type\": \"unpredicted\",\r\n            \"latitude\": location.coords.latitude,\r\n            \"longitude\": location.coords.longitude,\r\n        }\r\n\r\n        console.log('this is your data: ' + JSON.stringify(data))\r\n        axios\r\n            .post(`${Constants.ApiLink}/uploader`, data)\r\n            .then(async function (response) {\r\n                // handle success\r\n\r\n                try {\r\n                    const jsonValue = JSON.stringify(response.data);\r\n                    await AsyncStorage.setItem(\"value\", jsonValue);\r\n                    console.log(\"data: \" + jsonValue);\r\n                } catch (e) {\r\n                    // saving error\r\n                    console.log(\"Got error while storing data to async\" + e);\r\n                }\r\n            })\r\n            .catch(function (error) {\r\n                // handle error\r\n                console.log(\"ERROR ON HOME\", error);\r\n            })\r\n            .finally(function () {\r\n                // always executed\r\n            });\r\n        // console.log('This is my base 64 image', image)\r\n        await cameraRef.resumePreview()\r\n    }\r\n\r\n    async function account() {\r\n        navigation.navigate('Profile')\r\n    }\r\n\r\n    return (\r\n        <Grid style={styles.bottomToolbar}>\r\n            <Row>\r\n                <Col style={styles.alignCenter}>\r\n                    <TouchableOpacity onPress={() => navigation.navigate('EntryRecords')}>\r\n                        <MaterialIcons name=\"history\" size={30} color=\"white\" />\r\n                    </TouchableOpacity>\r\n                </Col>\r\n\r\n                <Col size={2} style={styles.alignCenter}>\r\n                    <TouchableWithoutFeedback\r\n                        onPress={takePicture}>\r\n                        <View style={[styles.captureBtn, capturing && styles.captureBtnActive]}>\r\n                            {capturing && <View style={styles.captureBtnInternal} />}\r\n                        </View>\r\n                    </TouchableWithoutFeedback>\r\n\r\n\r\n                </Col>\r\n                {\r\n                    IsImage ?\r\n                        <Col style={styles.alignCenter}>\r\n                            <TouchableOpacity onPress={uploadData}>\r\n                                <Feather name=\"check\" size={30} color=\"white\" />\r\n                            </TouchableOpacity>\r\n                        </Col> : <Col style={styles.alignCenter}>\r\n                            <TouchableOpacity onPress={account}>\r\n                                <MaterialCommunityIcons name=\"account\" size={30} color=\"white\" />\r\n                            </TouchableOpacity>\r\n                        </Col>\r\n                }\r\n            </Row>\r\n        </Grid>);\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module"}